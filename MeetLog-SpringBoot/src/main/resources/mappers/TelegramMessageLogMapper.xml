<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="mapper.TelegramMessageLogMapper">

    <!-- TelegramMessageLog ResultMap -->
    <resultMap id="TelegramMessageLogResultMap" type="model.TelegramMessageLog">
        <id property="id" column="id"/>
        <result property="tgLinkId" column="tg_link_id"/>
        <result property="chatId" column="chat_id"/>
        <result property="messageType" column="message_type"/>
        <result property="messageText" column="message_text"/>
        <result property="referenceType" column="reference_type"/>
        <result property="referenceId" column="reference_id"/>
        <result property="status" column="status"/>
        <result property="errorMessage" column="error_message"/>
        <result property="sentAt" column="sent_at"/>
    </resultMap>

    <!-- 메시지 로그 삽입 -->
    <insert id="insert" parameterType="model.TelegramMessageLog" useGeneratedKeys="true" keyProperty="id">
        INSERT INTO telegram_message_logs (
            tg_link_id,
            chat_id,
            message_type,
            message_text,
            reference_type,
            reference_id,
            status,
            error_message,
            sent_at
        ) VALUES (
            #{tgLinkId},
            #{chatId},
            #{messageType},
            #{messageText},
            #{referenceType},
            #{referenceId},
            #{status},
            #{errorMessage},
            CURRENT_TIMESTAMP
        )
    </insert>

</mapper>
